<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Freelynk - My Account</title>
  <link rel="stylesheet" href="../styles/account.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    .user-activities {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .activity-list {
      list-style-type: none;
      padding: 0;
    }
    .activity-item {
      padding: 10px;
      margin: 8px 0;
      background: white;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .activity-date {
      font-weight: bold;
      color: #333;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <main>
    <section id="dashboard" class="account-section">
      <h2>Welcome, <span id="user-name">User</span></h2>
      <button id="logout-btn">Logout</button>

      <section class="user-activities">
        <h3>Your Activities</h3>
        <div id="activitiesContainer"></div>
      </section>

      <section class="account-actions">
        <h3>Account Options</h3>
        <ul>
          <li><a href="#">Manage Profile</a></li>
          <li><a href="#">Post a New Project</a></li>
          <li><a href="detailed_milestone.html">View All Projects</a></li>
        </ul>
      </section>
    </section>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Load user activities
      const activities = JSON.parse(localStorage.getItem('userActivities') || '[]');
      const container = document.getElementById('activitiesContainer');
      
      if (activities.length === 0) {
        container.innerHTML = '<p>No activities recorded yet.</p>';
        return;
      }

      // Group activities by date
      const activitiesByDate = activities.reduce((groups, activity) => {
        const date = new Date(activity.timestamp).toLocaleDateString();
        if (!groups[date]) groups[date] = [];
        groups[date].push(activity);
        return groups;
      }, {});

      // Display activities
      let html = '';
      for (const [date, dailyActivities] of Object.entries(activitiesByDate)) {
        html += `<p class="activity-date">${date}</p><ul class="activity-list">`;
        
        dailyActivities.forEach(activity => {
          if (activity.type === 'hired_freelancer') {
            html += `
              <li class="activity-item">
                Hired <strong>${activity.data.name}</strong> as ${activity.data.title}
                <small>(${new Date(activity.timestamp).toLocaleTimeString()})</small>
              </li>
            `;
          } else if (activity.type === 'added_skills') {
            html += `
              <li class="activity-item">
                Added skills: <strong>${activity.data.skills.join(', ')}</strong>
                <small>(${new Date(activity.timestamp).toLocaleTimeString()})</small>
              </li>
            `;
          }
        });
        
        html += '</ul>';
      }
      
      container.innerHTML = html;

      // Logout functionality
      document.getElementById('logout-btn').addEventListener('click', function() {
        localStorage.removeItem('userActivities');
        window.location.href = 'index2.html';
      });
    });
  </script>

<section class="user-activities">
  <h2>Your Activities</h2>
  <div id="activitiesList"></div>
</section>

<script>
  // Display activities
  document.addEventListener('DOMContentLoaded', function() {
    const activities = JSON.parse(localStorage.getItem('userActivities') || '[]');
    const list = document.getElementById('activitiesList');
    
    if (activities.length === 0) {
      list.innerHTML = '<p>No activities yet</p>';
      return;
    }

    let html = '';
    activities.forEach(activity => {
      if (activity.type === 'hired') {
        html += `<p>Hired ${activity.data.name} (${activity.data.title})</p>`;
      }
      if (activity.type === 'added_skills') {
        html += `<p>Added skills: ${activity.data.skills.join(', ')}</p>`;
      }
    });
    
    list.innerHTML = html;
  });
</script>
</body>
</html>